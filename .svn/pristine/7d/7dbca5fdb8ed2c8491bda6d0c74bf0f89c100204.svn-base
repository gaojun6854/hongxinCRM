<%@page import="java.util.UUID"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %> 

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<%
	String path = request.getContextPath();
	String basePath = request.getScheme() + "://" + request.getServerName() + ":" + request.getServerPort()
			+ path;
%>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="content-script-type" content="text/javascript">
<meta http-equiv="content-style-type" content="text/css">
<meta http-equiv="content-language" content="en-gb">
<meta http-equiv="imagetoolbar" content="no" />
<link rel="stylesheet" href="../css/custom/dataTable.css" media="screen">
<style type="text/css">
body, th, td { font-family: Arial, Verdana, sans-serif; font-size: 0.9em; }
a:link, a:visited { color: #59B337; }
a:hover, a:active, a:focus { color: #000000; }
table.dataTable tr.marked { background-color: #FFD900; }
</style>
<style type="text/css">
*{margin:0;padding:0;list-style-type:none;}
a,img{border:0;}
/* reveal-modal */
.reveal-modal-bg{position:fixed;height:100%;width:100%;background-color:#000;z-index:100;display:none;top:0;left:0;}
.reveal-modal{visibility:hidden;top:100px;left:50%;margin-left:-300px;width:420px;background:#eee url(../images/modal-gloss.png) no-repeat -200px -80px;position:absolute;z-index:101;padding:30px 40px 34px;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;-moz-box-shadow:0 0 10px rgba(0,0,0,.4);-webkit-box-shadow:0 0 10px rgba(0,0,0,.4);-box-shadow:0 0 10px rgba(0,0,0,.4);}
.reveal-modal .close-reveal-modal {
font-size:22px;line-height:.5;position:absolute;top:8px;right:11px;color:#aaa;text-shadow:0 -1px 1px rbga(0,0,0,.6);font-weight:bold;cursor:pointer;} 
.reveal-modal h2{font-size:18px;color:#990000;padding:0 0 20px 0;}
.reveal-modal p{padding:0 0 15px 0;}
</style>
				<%
				request.setAttribute("picType", 2);
				request.setAttribute("url", "pact/pactInfo!offLineReviewsUpload.action");//上传图片后跳转的地址
				;
			%>
<!-- jquery packed -->
<script type="text/javascript" src="../js/jquery.js"></script>
<!-- tableRowCheckboxToggle -->
<script type="text/javascript" src="../js/tableRowCheckboxToggle.js"></script>
<script type="text/javascript" src="../js/jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="../js/jquery.reveal.js"></script>
<title>线上线下合约审核</title>
</head>
<body>
<h1 align="center" style="color: highlight;">合约审核</h1>
<span style="color: red; font-size: 15px;">${requestScope.flag}<br /></span>
<table border="0" cellspacing="0" cellpadding="0" class="dataTable">
  <thead>
    <tr>
     <th class="dataTableHeader">合同号</th>
	 <th class="dataTableHeader">产品名</th>
	  <th class="dataTableHeader">产品融资方银行账号</th>
	 <th class="dataTableHeader">产品融资方账号</th>
	 <th class="dataTableHeader">本金</th>
	 <th class="dataTableHeader">利率</th>
	 <th class="dataTableHeader">利息</th>
	 <th class="dataTableHeader">客户经理</th>
	 <th class="dataTableHeader">团队</th>
	 <th class="dataTableHeader">状态</th>
	 <th class="dataTableHeader">操作</th>
    </tr>
  </thead>
  <tbody>
   <c:forEach items="${pactInfos}" var="pactInfo">
    <tr class="odd_row">
    <c:if test="${away=='PZoffline'}">
      <td><input type="hidden"  readonly="readonly" id="checkme1" /><a href="pactInfo!getPactInfos.action?no=3&id=${pactInfo.pactId}&redirect=PZoffline">${pactInfo.contractNumber}</a></td>
      </c:if>
      <c:if test="${away == 'online'}">
      <td><input type="hidden"  readonly="readonly" id="checkme1" /><a href="pactInfo!getPactInfos.action?no=2&id=${pactInfo.pactId}&redirect=online">${pactInfo.contractNumber}</a></td>
      </c:if>
      <c:if test="${away == 'offline'}">
      <td><input type="hidden"  readonly="readonly" id="checkme1" /><a href="pactInfo!getPactInfos.action?no=2&id=${pactInfo.pactId}&redirect=offline">${pactInfo.contractNumber}</a></td>
      </c:if>
	  <td><input type="hidden" readonly="readonly" id="checkme1" />${pactInfo.productInfo.productName }</td>
	  <td><input type="hidden" readonly="readonly" id="checkme1" />${pactInfo.productInfo.bankAccout }</td>
	  <td><input type="hidden" readonly="readonly" id="checkme1" />${pactInfo.productInfo.fuyouAccout }</td>
	  <td><input type="hidden" readonly="readonly" id="checkme1" />${pactInfo.amount}</td>
	  <td><input type="hidden" readonly="readonly" id="checkme1" />${pactInfo.recruitmentDate }</td>
	  <td><input type="hidden" readonly="readonly" id="checkme1" /><fmt:formatNumber value="${pactInfo.amount*(1+pactInfo.recruitmentDate)}" pattern="0.00"/> </td>
	 <td><input type="hidden" readonly="readonly" id="checkme1" />${pactInfo.managerName }</td>
	 <td><input type="hidden" readonly="readonly" id="checkme1" />${pactInfo.termName }</td>
	 <td><input type="hidden" readonly="readonly" id="checkme1" />
	 <c:set var="pactFlow">${pactInfo.pactFlow}</c:set>  
	 <c:set var="checkStart">${pactInfo.checkStart}</c:set>  
		 <c:choose>  
			 <c:when test="${pactFlow==2 && checkStart==1}">初审中</c:when>
			 <c:when test="${pactFlow==2 && checkStart==3}">初审失败</c:when>
			 <c:when test="${pactFlow==1 && checkStart==1}">复审中</c:when>
			 <c:when test="${pactFlow==1 && checkStart==3}">复审失败</c:when>
			 <c:when test="${pactFlow==3 && checkStart==2}">已通过</c:when>
			 <c:when test="${pactFlow==5 && checkStart==2}">还款中</c:when>
			 <c:when test="${pactFlow==4 && checkStart==1}">回购中</c:when>
			 <c:when test="${pactFlow==7 && checkStart==1}">线下审核中</c:when>
			  <c:when test="${pactFlow==7 && checkStart==3}">线下审核失败</c:when>
			 <c:when test="${pactFlow==6 && checkStart==2}">合同结束</c:when>
		 </c:choose>
	 </td>
	 
	  <td><input type="hidden" readonly="readonly" id="checkme1" />
	  <c:if test="${away=='online'}">
	  	<a href="pactInfo!onLineReviewsYN.action?id=${pactInfo.pactId}&param=yes">通过</a>
	 	<a href="javascript:void(0);" data-reveal-id="myModal">不通过</a>
	 		<div id="myModal" class="reveal-modal">
				<form action="pactInfo!onLineReviewsYN.action" method="post" id="nopass">
					<h2>请填写未通过原因</h2>
					<input type="hidden" name="id" value="${pactInfo.pactId}" />
					<input type="hidden" name="param" value="no" />
					<textarea id="Reson" rows="6" cols="20"></textarea>
					<input type="hidden" name="noPassReson" id="noPassReson" />
					<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<input  type="button" value="提交" onclick="javascript:aa();" /></p>
				</form>
			</div>
	  </c:if>
	  <c:if test="${away=='offline'}">
	  	<a href="pactInfo!redirectURL.action?pactId=${pactInfo.pactId}">上传图片</a>
	  </c:if>
	  <c:if test="${away=='PZoffline'}">
	  	<a href="pactInfo!offLineReviewsYN.action?id=${pactInfo.pactId}&param=yes">通过</a>
	  	<a href="javascript:void(0);" data-reveal-id="myModal">不通过</a>
	 		<div id="myModal" class="reveal-modal">
				<form action="pactInfo!offLineReviewsYN.action" method="post" id="nopass">
					<h2>请填写未通过原因</h2>
					<input type="hidden" name="id" value="${pactInfo.pactId}" />
					<input type="hidden" name="param" value="no" />
					<textarea id="Reson" rows="6" cols="20"></textarea>
					<input type="hidden" name="noPassReson" id="noPassReson" />
					<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<input  type="button" value="提交" onclick="javascript:aa();" /></p>
				</form>
			</div>
	  </c:if>	
    </tr>
   </c:forEach>
  </tbody>
</table>
<script type="text/javascript">
	function aa(){
		var reson=$("#Reson").val();
		$("#noPassReson").val(reson);
		$("#nopass").submit();
	}
</script>
</body>
</html>
